$domain = "domain"#domain name goes here $prefix = "<com/local/etc>" #domain end (com/local) $searcher = New-Object DirectoryServices.DirectorySearcher $searcher.Filter = '(objectclass=computer)' $searcher.SearchRoot = "LDAP://DC=$domain,DC=$prefix" $searcher.FindAll() | ForEach-Object { $_.GetDirectoryEntry() } | Select-Object Name, OperatingSystem, OperatingSystemVersion, DistinguishedName | Format-List