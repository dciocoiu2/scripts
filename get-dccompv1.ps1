$DomainDn= "" # this is the domain DN manually set, comment out and uncomment the next line to get it dynamicall #$DomainDN = ([System.DirectoryServices.ActiveDirectory.Domain]::GetComputerDomain()).GetDirectoryEntry().distinguishedName #this line can be used to get the domain DN dynamically $SearchBase = "LDAP://$DomainDN" $Searcher = New-Object System.DirectoryServices.DirectorySearcher $Searcher.SearchRoot = New-Object System.DirectoryServices.DirectoryEntry($SearchBase) $Searcher.Filter = "(objectClass=computer)" #$Searcher.SearchScope = "Subtree" $Searcher.SearchScope = [System.DirectoryServices.SearchScope]::Subtree $Searcher.PropertiesToLoad.Add("*") # Optionally, specify which properties to retrieve #$Searcher.PropertiesToLoad.Add("name") $Results = $Searcher.FindAll() foreach ($Result in $Results) {     $ComputerProperties = [PSCustomObject]@{ }     foreach ($Property in $Result.Properties.PropertyNames) {         $Value = $Result.Properties[$Property]         if ($Value.Count -eq 1) {             Add-Member -InputObject $ComputerProperties -NotePropertyName $Property -NotePropertyValue $Value[0]         } else {             Add-Member -InputObject $ComputerProperties -NotePropertyName $Property -NotePropertyValue ($Value | ForEach-Object { $_ })         }     }     $ComputerProperties | Format-List }